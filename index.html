

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>h5netcdf: A Python interface for the netCDF4 file-format based on h5py &#8212; h5netcdf - 1.2.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="canonical" href="https://h5netcdf.org/index.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="legacyapi vs new API feature comparison" href="feature.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    <p class="title logo__title">h5netcdf - 1.2.0</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">For users</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature.html">Feature comparison</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">New API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.File.html">h5netcdf.File</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.File.create_group.html">h5netcdf.File.create_group</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.File.create_variable.html">h5netcdf.File.create_variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.File.resize_dimension.html">h5netcdf.File.resize_dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.Group.html">h5netcdf.Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.Dimension.html">h5netcdf.Dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.Variable.html">h5netcdf.Variable</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="legacyapi.html">Legacy API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Dataset.html">h5netcdf.legacyapi.Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Dataset.createGroup.html">h5netcdf.legacyapi.Dataset.createGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Dataset.createDimension.html">h5netcdf.legacyapi.Dataset.createDimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Dataset.createVariable.html">h5netcdf.legacyapi.Dataset.createVariable</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Group.html">h5netcdf.legacyapi.Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Dimension.html">h5netcdf.legacyapi.Dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/h5netcdf.legacyapi.Variable.html">h5netcdf.legacyapi.Variable</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">For developers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="devguide.html">Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/h5netcdf/h5netcdf/issues">GitHub issues</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/h5netcdf/h5netcdf" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/h5netcdf/h5netcdf/edit/main/doc/index.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/h5netcdf/h5netcdf/issues/new?title=Issue%20on%20page%20%2Findex.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>h5netcdf: A Python interface for the netCDF4 file-format based on h5py</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-h5netcdf">Why h5netcdf?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install">Install</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-api">New API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#legacy-api">Legacy API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invalid-netcdf-files">Invalid netCDF files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-variable-length-strings">Decoding variable length strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-with-missing-dimension-scales">Datasets with missing dimension scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#track-order">Track Order</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indices-and-tables">Indices and tables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="h5netcdf-a-python-interface-for-the-netcdf4-file-format-based-on-h5py">
<h1>h5netcdf: A Python interface for the netCDF4 file-format based on h5py<a class="headerlink" href="#h5netcdf-a-python-interface-for-the-netcdf4-file-format-based-on-h5py" title="Permalink to this heading">#</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Release<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://github.com/h5netcdf/h5netcdf/tree/v1.2.0">1.2.0</a></p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>Jun 02, 2023</p>
</dd>
</dl>
<p><strong>h5netcdf</strong> is an open source project and Python package that provides an interface
for the <a class="reference external" href="https://docs.unidata.ucar.edu/netcdf-c/current/file_format_specifications.html#netcdf_4_spec">netCDF4 file-format</a> that reads and writes local or remote HDF5 files directly
via <a class="reference external" href="https://www.h5py.org/">h5py</a> or <a class="reference external" href="https://github.com/HDFGroup/h5pyd">h5pyd</a>, without relying on the Unidata netCDF library.</p>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<section id="why-h5netcdf">
<h2>Why h5netcdf?<a class="headerlink" href="#why-h5netcdf" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>It has one less binary dependency (netCDF C). If you already have h5py
installed, reading netCDF4 with h5netcdf may be much easier than installing
netCDF4-Python.</p></li>
<li><p>We’ve seen occasional reports of better performance with h5py than
netCDF4-python, though in many cases performance is identical. For
<a class="reference external" href="https://github.com/Unidata/netcdf4-python/issues/390#issuecomment-93864839">one workflow</a>, h5netcdf was reported to be almost <strong>4x faster</strong> than
<a class="reference external" href="https://github.com/Unidata/netcdf4-python">netCDF4-python</a>.</p></li>
<li><p>Anecdotally, HDF5 users seem to be unexcited about switching to netCDF –
hopefully this will convince them that netCDF4 is actually quite sane!</p></li>
<li><p>Finally, side-stepping the netCDF C library (and Cython bindings to it)
gives us an easier way to identify the source of performance issues and
bugs in the netCDF libraries/specification.</p></li>
</ul>
</section>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this heading">#</a></h2>
<p>Ensure you have a recent version of h5py installed (I recommend using <a class="reference external" href="https://conda.io/">conda</a> or
the community effort <a class="reference external" href="https://conda-forge.org/">conda-forge</a>).
At least version 3.0 is required. Then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install h5netcdf
</pre></div>
</div>
<p>Or if you are already using conda:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install h5netcdf
</pre></div>
</div>
<p>Note:</p>
<p>From version 1.2. h5netcdf tries to align with a <a class="reference external" href="https://numpy.org/neps/nep-0029-deprecation_policy.html">nep29</a>-like support policy with regard
to it’s upstream dependencies.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<p>h5netcdf has two APIs, a new API and a legacy API. Both interfaces currently
reproduce most of the features of the netCDF interface, with the notable
exception of support for operations that rename or delete existing objects.
We simply haven’t gotten around to implementing this yet. Patches
would be very welcome.</p>
<section id="new-api">
<h3>New API<a class="headerlink" href="#new-api" title="Permalink to this heading">#</a></h3>
<p>The new API supports direct hierarchical access of variables and groups. Its
design is an adaptation of h5py to the netCDF data model. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5netcdf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">with</span> <span class="n">h5netcdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;mydata.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># set dimensions with a dictionary</span>
    <span class="n">f</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
    <span class="c1"># and update them with a dict-like interface</span>
    <span class="c1"># f.dimensions[&#39;x&#39;] = 5</span>
    <span class="c1"># f.dimensions.update({&#39;x&#39;: 5})</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">create_variable</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,),</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># you don&#39;t need to create groups first</span>
    <span class="c1"># you also don&#39;t need to create dimensions first if you supply data</span>
    <span class="c1"># with the new variable</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">create_variable</span><span class="p">(</span><span class="s1">&#39;/grouped/data&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,),</span> <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># access and modify attributes with a dict-like interface</span>
    <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>

    <span class="c1"># you can access variables and groups directly using a hierarchical</span>
    <span class="c1"># keys like h5py</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;/grouped/data&#39;</span><span class="p">])</span>

    <span class="c1"># add an unlimited dimension</span>
    <span class="n">f</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># explicitly resize a dimension and all variables using it</span>
    <span class="n">f</span><span class="o">.</span><span class="n">resize_dimension</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li><p>Automatic resizing of unlimited dimensions with array indexing is not available.</p></li>
<li><p>Dimensions need to be manually resized with <code class="docutils literal notranslate"><span class="pre">Group.resize_dimension(dimension,</span> <span class="pre">size)</span></code>.</p></li>
<li><p>Arrays are returned padded with <code class="docutils literal notranslate"><span class="pre">fillvalue</span></code> (taken from underlying hdf5 dataset) up to
current size of variable’s dimensions. The behaviour is equivalent to netCDF4-python’s
<code class="docutils literal notranslate"><span class="pre">Dataset.set_auto_mask(False)</span></code>.</p></li>
</ul>
</section>
<section id="legacy-api">
<h3>Legacy API<a class="headerlink" href="#legacy-api" title="Permalink to this heading">#</a></h3>
<p>The legacy API is designed for compatibility with <a class="reference external" href="https://github.com/Unidata/netcdf4-python">netCDF4-python</a>. To use it, import
<code class="docutils literal notranslate"><span class="pre">h5netcdf.legacyapi</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5netcdf.legacyapi</span> <span class="k">as</span> <span class="nn">netCDF4</span>
<span class="c1"># everything here would also work with this instead:</span>
<span class="c1"># import netCDF4</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">with</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;mydata.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds</span><span class="p">:</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,))</span>
    <span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">createGroup</span><span class="p">(</span><span class="s1">&#39;grouped&#39;</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,))</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="s1">&#39;grouped&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The legacy API is designed to be easy to try-out for netCDF4-python users, but it is not an
exact match. Here is an incomplete list of functionality we don’t include:</p>
<ul class="simple">
<li><p>Utility functions <code class="docutils literal notranslate"><span class="pre">chartostring</span></code>, <code class="docutils literal notranslate"><span class="pre">num2date</span></code>, etc., that are not directly necessary
for writing netCDF files.</p></li>
<li><p>h5netcdf variables do not support automatic masking or scaling (e.g., of values matching
the <code class="docutils literal notranslate"><span class="pre">_FillValue</span></code> attribute). We prefer to leave this functionality to client libraries
(e.g., <a class="reference external" href="https://github.com/pydata/xarray/">xarray</a>), which can implement their exact desired scaling behavior. Nevertheless
arrays are returned padded with <code class="docutils literal notranslate"><span class="pre">fillvalue</span></code> (taken from underlying hdf5 dataset) up to
current size of variable’s dimensions. The behaviour is equivalent to netCDF4-python’s
<code class="docutils literal notranslate"><span class="pre">Dataset.set_auto_mask(False)</span></code>.</p></li>
</ul>
</section>
<section id="invalid-netcdf-files">
<span id="invalid-netcdf"></span><h3>Invalid netCDF files<a class="headerlink" href="#invalid-netcdf-files" title="Permalink to this heading">#</a></h3>
<p>h5py implements some features that do not (yet) result in valid netCDF files:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Data types:</dt><dd><ul>
<li><p>Booleans</p></li>
<li><p>Complex values</p></li>
<li><p>Non-string variable length types</p></li>
<li><p>Enum types</p></li>
<li><p>Reference types</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Arbitrary filters:</dt><dd><ul>
<li><p>Scale-offset filters</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>By default <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, h5netcdf will not allow writing files using any of these features,
as files with such features are not readable by other netCDF tools.</p>
<p>However, these are still valid HDF5 files. If you don’t care about netCDF
compatibility, you can use these features by setting <code class="docutils literal notranslate"><span class="pre">invalid_netcdf=True</span></code>
when creating a file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># avoid the .nc extension for non-netcdf files</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">h5netcdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;mydata.h5&#39;</span><span class="p">,</span> <span class="n">invalid_netcdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>

<span class="c1"># works with the legacy API, too, though compression options are not exposed</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">h5netcdf</span><span class="o">.</span><span class="n">legacyapi</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;mydata.h5&#39;</span><span class="p">,</span> <span class="n">invalid_netcdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In such cases the <cite>_NCProperties</cite> attribute will not be saved to the file or be removed
from an existing file. A warning will be issued if the file has <cite>.nc</cite>-extension.</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>h5netcdf we will raise <code class="docutils literal notranslate"><span class="pre">h5netcdf.CompatibilityError</span></code>.</p>
</aside>
</aside>
</section>
<section id="decoding-variable-length-strings">
<h3>Decoding variable length strings<a class="headerlink" href="#decoding-variable-length-strings" title="Permalink to this heading">#</a></h3>
<p>h5py 3.0 introduced <a class="reference external" href="https://docs.h5py.org/en/stable/strings.html">new behavior</a> for handling variable length string.
Instead of being automatically decoded with UTF-8 into NumPy arrays of <code class="docutils literal notranslate"><span class="pre">str</span></code>,
they are required as arrays of <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
<p>The legacy API preserves the old behavior of h5py (which matches netCDF4),
and automatically decodes strings.</p>
<p>The new API matches h5py behavior. Explicitly set <code class="docutils literal notranslate"><span class="pre">decode_vlen_strings=True</span></code>
in the <code class="docutils literal notranslate"><span class="pre">h5netcdf.File</span></code> constructor to opt-in to automatic decoding.</p>
</section>
<section id="datasets-with-missing-dimension-scales">
<span id="phony-dims"></span><h3>Datasets with missing dimension scales<a class="headerlink" href="#datasets-with-missing-dimension-scales" title="Permalink to this heading">#</a></h3>
<p>By default <a class="footnote-reference brackets" href="#id4" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> h5netcdf raises a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if variables with no dimension
scale associated with one of their axes are accessed.
You can set <code class="docutils literal notranslate"><span class="pre">phony_dims='sort'</span></code> when opening a file to let h5netcdf invent
phony dimensions according to <a class="reference external" href="https://docs.unidata.ucar.edu/netcdf-c/current/interoperability_hdf5.html">netCDF</a> behaviour.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># mimic netCDF-behaviour for non-netcdf files</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">h5netcdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;mydata.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">phony_dims</span><span class="o">=</span><span class="s1">&#39;sort&#39;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Note, that this iterates once over the whole group-hierarchy. This has affects
on performance in case you rely on laziness of group access.
You can set <code class="docutils literal notranslate"><span class="pre">phony_dims='access'</span></code> instead to defer phony dimension creation
to group access time. The created phony dimension naming will differ from
<a class="reference external" href="https://docs.unidata.ucar.edu/netcdf-c/current/interoperability_hdf5.html">netCDF</a> behaviour.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">h5netcdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;mydata.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">phony_dims</span><span class="o">=</span><span class="s1">&#39;access&#39;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Keyword default setting <code class="docutils literal notranslate"><span class="pre">phony_dims=None</span></code> for backwards compatibility.</p>
</aside>
</aside>
</section>
<section id="track-order">
<h3>Track Order<a class="headerlink" href="#track-order" title="Permalink to this heading">#</a></h3>
<p>As of h5netcdf 1.1.0, if h5py 3.7.0 or greater is detected, the <code class="docutils literal notranslate"><span class="pre">track_order</span></code>
parameter is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> enabling <a class="reference external" href="https://docs.unidata.ucar.edu/netcdf-c/current/file_format_specifications.html#creation_order">order tracking</a> for newly created
netCDF4 files. This helps ensure that files created with the h5netcdf library
can be modified by the netCDF4-c and netCDF4-python implementation used in
other software stacks. Since this change should be transparent to most users,
it was made without deprecation.</p>
<p>Since track_order is set at creation time, any dataset that was created with
<code class="docutils literal notranslate"><span class="pre">track_order=False</span></code> (h5netcdf version 1.0.2 and older except for 0.13.0) will
continue to opened with order tracker disabled.</p>
<p>The following describes the behavior of h5netcdf with respect to order tracking
for a few key versions:</p>
<ul class="simple">
<li><p>Version 0.12.0 and earlier, the <code class="docutils literal notranslate"><span class="pre">track_order</span></code> parameter`order was missing
and thus order tracking was implicitely set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>Version 0.13.0 enabled order tracking by setting the parameter
<code class="docutils literal notranslate"><span class="pre">track_order</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> by default without deprecation.</p></li>
<li><p>Versions 0.13.1 to 1.0.2 set <code class="docutils literal notranslate"><span class="pre">track_order</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> due to a bug in a
core dependency of h5netcdf, h5py <a class="reference external" href="https://github.com/h5netcdf/h5netcdf/issues/136">upstream bug</a> which was resolved in h5py
3.7.0 with the help of the h5netcdf team.</p></li>
<li><p>In version 1.1.0, if h5py 3.7.0 or above is detected, the <code class="docutils literal notranslate"><span class="pre">track_order</span></code>
parameter is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</p></li>
</ul>
</section>
</section>
<section id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this heading">#</a></h2>
<p>The project was started in early 2015. The first commit was made on 7th of April in 2015
by Stephan Hoyer. The first <cite>official</cite> <code class="docutils literal notranslate"><span class="pre">h5netcdf</span></code> announcement was made by Stephan on the
<a class="reference external" href="https://github.com/pydata/xarray/issues/23#issuecomment-90780331">xarray issue tracker</a> only one day later.</p>
<p>The library evolved constantly over the years (fixing bugs and adding enhancements)
and gained contributions from 15 other <a class="reference internal" href="devguide.html#contributors"><span class="std std-ref">Contributors</span></a> so far. The library is widely used,
especially as backend within <a class="reference external" href="https://github.com/pydata/xarray/">xarray</a>.</p>
<p>Early 2020 Kai Mühlbauer started to add contributions and after some time he volunteered
to help in maintaining <code class="docutils literal notranslate"><span class="pre">h5netcdf</span></code>. Two years later in January 2022 Stephan handed the
project-lead over to Kai. <code class="docutils literal notranslate"><span class="pre">h5netcdf</span></code> version 1.0 was released on 31st of March 2022.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/h5netcdf/h5netcdf/blob/main/LICENSE">3-clause BSD</a></p>
</section>
<section id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="right-next"
       href="feature.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">legacyapi vs new API feature comparison</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-h5netcdf">Why h5netcdf?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install">Install</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-api">New API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#legacy-api">Legacy API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invalid-netcdf-files">Invalid netCDF files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-variable-length-strings">Decoding variable length strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-with-missing-dimension-scales">Datasets with missing dimension scales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#track-order">Track Order</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indices-and-tables">Indices and tables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2015-2023, h5netcdf developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>